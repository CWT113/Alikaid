# 鼠标事件

首先使用 [ScreenSpaceEventHandler](https://cesium.com/learn/cesiumjs/ref-doc/ScreenSpaceEventHandler.html?classFilter=ScreenSpaceEventHandler) 为地图创建一层画布，然后使用 [`setInputAction()`](https://cesium.com/learn/cesiumjs/ref-doc/global.html#ScreenSpaceEventType) 方法设置鼠标事件。



鼠标点击事件列举：

```js
// 添加画布
const canvas = new Cesium.ScreenSpaceEventHandler(viewer.scene.canvas);

// 鼠标左键点击
canvas.setInputAction((e) => {}, cesium.ScreenSpaceEventType.LEFT_CLICK);
// 鼠标左键双击
canvas.setInputAction((e) => {}, cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK);
// 鼠标左键按下
canvas.setInputAction((e) => {}, cesium.ScreenSpaceEventType.LEFT_DOWN);
// 鼠标左键抬起
canvas.setInputAction((e) => {}, cesium.ScreenSpaceEventType.LEFT_UP);

// 鼠标中键点击
canvas.setInputAction((e) => {}, cesium.ScreenSpaceEventType.MIDDLE_CLICK);
// 鼠标中键按下
canvas.setInputAction((e) => {}, cesium.ScreenSpaceEventType.MIDDLE_DOWN);
// 鼠标中键抬起
canvas.setInputAction((e) => {}, cesium.ScreenSpaceEventType.MIDDLE_UP);

// 鼠标右键单击
canvas.setInputAction((e) => {}, cesium.ScreenSpaceEventType.RIGHT_CLICK);
// 鼠标右键按下
canvas.setInputAction((e) => {}, cesium.ScreenSpaceEventType.RIGHT_DOWN);
// 鼠标右键抬起
canvas.setInputAction((e) => {}, cesium.ScreenSpaceEventType.RIGHT_UP);

// 鼠标移动
canvas.setInputAction((e) => {}, cesium.ScreenSpaceEventType.MOUSE_MOVE);

// 鼠标滚动
canvas.setInputAction((e) => {}, cesium.ScreenSpaceEventType.RIGHT_UP);
```

<br />

获取鼠标所在位置坐标：

```js
const canvas = new Cesium.ScreenSpaceEventHandler(viewer.canvas);

canvas.setInputAction(e => {
  // 方式一
  const pickPosition = viewer.scene.camera.pickEllipsoid(e.position);
  // 严格校验pickPosition是否为undefined
  if (Cesium.defined(pickPosition)) {
    // 笛卡尔坐标转为弧度坐标
    const Cartographic = Cesium.Cartographic.fromCartesian(pickPosition);
    const lng = Cesium.Math.toDegrees(Cartographic.longitude);
    const lat = Cesium.Math.toDegrees(Cartographic.latitude);
    console.log({ lng, lat });
  }

  // 方式二
  // 根据屏幕位置获取摄像机射线
  let ray = viewer.camera.getPickRay(e.position);
  // 获取射线与地球表面的交点
  let cartesian = viewer.scene.globe.pick(ray, viewer.scene);
  if (Cesium.defined(cartesian)) {
    let cartographic = Cesium.Cartographic.fromCartesian(cartesian);
    let lng = Cesium.Math.toDegrees(cartographic.longitude);
    let lat = Cesium.Math.toDegrees(cartographic.latitude);
    console.log({ lng, lat });
  }
}, Cesium.ScreenSpaceEventType.LEFT_CLICK);
```

<br />

鼠标滑过 3D Tiles 模型时，模型变为黄色，当鼠标移出时恢复原状：

- 添加纽约市 3D Tiles 数据：

  ```js
  const tileset = viewer.scene.primitives.add(
    // 加载纽约建筑物3D Tiles
    await Cesium.Cesium3DTileset.fromIonAssetId(75343)
  );
  viewer.flyTo(tileset);
  ```

- 添加鼠标移动事件：

  ```js
  let pickModel:any;
  
  const handler = new Cesium.ScreenSpaceEventHandler(viewer.scene.canvas);
  
  handler.setInputAction(e => {
    const pick = viewer.scene.pick(e.endPosition);
    if (!pick) return;
    if (pick && pickModel) {
      pickModel.color = Cesium.Color.WHITE;
    }
    pick.color = Cesium.Color.ORANGE;
    pickModel = pick;
  }, Cesium.ScreenSpaceEventType.MOUSE_MOVE);
  ```
![Point](./images/pickmodel.gif)
